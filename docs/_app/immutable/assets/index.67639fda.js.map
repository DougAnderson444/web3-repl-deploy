{"version":3,"file":"index.js","sources":["../svelte-sites/packages/repl/package/workers/compiler/index.js"],"sourcesContent":["self.window = self; // egregious hack to get magic-string to work in a worker\r\n\r\nlet fulfil_ready;\r\nconst ready = new Promise((f) => {\r\n\tfulfil_ready = f;\r\n});\r\n\r\nself.addEventListener('message', async (event) => {\r\n\tswitch (event.data.type) {\r\n\t\tcase 'init':\r\n\t\t\ttry {\r\n\t\t\t\timportScripts(`${event.data.svelteUrl}/compiler.js`);\r\n\t\t\t} catch {\r\n\t\t\t\tawait import(/* @vite-ignore */ `${event.data.svelteUrl}/compiler.js`);\r\n\t\t\t}\r\n\r\n\t\t\tfulfil_ready();\r\n\t\t\tbreak;\r\n\r\n\t\tcase 'compile':\r\n\t\t\tawait ready;\r\n\t\t\tpostMessage(compile(event.data));\r\n\t\t\tbreak;\r\n\t}\r\n});\r\n\r\nconst common_options = {\r\n\tdev: false,\r\n\tcss: false\r\n};\r\n\r\nfunction compile({ id, source, options, return_ast }) {\r\n\ttry {\r\n\t\tconst { js, css, ast } = svelte.compile(source, Object.assign({}, common_options, options));\r\n\r\n\t\treturn {\r\n\t\t\tid,\r\n\t\t\tresult: {\r\n\t\t\t\tjs: js.code,\r\n\t\t\t\tcss: css.code || `/* Add a <sty` + `le> tag to see compiled CSS */`,\r\n\t\t\t\tast: return_ast ? ast : null\r\n\t\t\t}\r\n\t\t};\r\n\t} catch (err) {\r\n\t\tlet message = `/* Error compiling component\\n\\n${err.message}`;\r\n\t\tif (err.frame) message += `\\n${err.frame}`;\r\n\t\tmessage += `\\n\\n*/`;\r\n\r\n\t\treturn {\r\n\t\t\tid,\r\n\t\t\tresult: {\r\n\t\t\t\tjs: message,\r\n\t\t\t\tcss: message\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n}\r\n"],"names":[],"mappings":"AAAA,KAAK,SAAS;AAEd,IAAI;AACJ,MAAM,QAAQ,IAAI,QAAQ,CAAC,MAAM;AAChC,iBAAe;AAChB,CAAC;AAED,KAAK,iBAAiB,WAAW,OAAO,UAAU;AACjD,UAAQ,MAAM,KAAK;AAAA,SACb;AACJ,UAAI;AACH,sBAAc,GAAG,MAAM,KAAK,uBAAuB;AAAA,MACvD,QAAK;AACD,cAAM;AAAA;AAAA,UAA0B,GAAG,MAAM,KAAK;AAAA;AAAA,MAC9C;AAED;AACA;AAAA,SAEI;AACJ,YAAM;AACN,kBAAY,QAAQ,MAAM,IAAI,CAAC;AAC/B;AAAA;AAEH,CAAC;AAED,MAAM,iBAAiB;AAAA,EACtB,KAAK;AAAA,EACL,KAAK;AACN;AAEA,iBAAiB,EAAE,IAAI,QAAQ,SAAS,cAAc;AACrD,MAAI;AACH,UAAM,EAAE,IAAI,KAAK,QAAQ,OAAO,QAAQ,QAAQ,OAAO,OAAO,CAAA,GAAI,gBAAgB,OAAO,CAAC;AAE1F,WAAO;AAAA,MACN;AAAA,MACA,QAAQ;AAAA,QACP,IAAI,GAAG;AAAA,QACP,KAAK,IAAI,QAAQ;AAAA,QACjB,KAAK,aAAa,MAAM;AAAA,MACxB;AAAA,IACJ;AAAA,EACE,SAAQ,KAAP;AACD,QAAI,UAAU;AAAA;AAAA,EAAmC,IAAI;AACrD,QAAI,IAAI;AAAO,iBAAW;AAAA,EAAK,IAAI;AACnC,eAAW;AAAA;AAAA;AAEX,WAAO;AAAA,MACN;AAAA,MACA,QAAQ;AAAA,QACP,IAAI;AAAA,QACJ,KAAK;AAAA,MACL;AAAA,IACJ;AAAA,EACE;AACF;"}